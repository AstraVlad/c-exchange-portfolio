# Основные функции биржевого терминала
## Регистрация
Обеспечение регистрации нового пользователя. Можно для простоты сделать стандартный вариант "электронная почта/телефон + пароль" с подтверждением адреса электронной почты. Я не знаю как правильно (и бесплатно/очень дешёво :)) сделать подтверждение телефона, если кто-то подскажет, сделаю. Если нет, то оставлю заглушку. Очень хорошо было бы прикрутить OAuth (говорили об этом на митинге) через Гугл/Фейсбук/ЛинкедИн.

Учётная запись нового пользователя изначально помещается в группу "Гости" с ограниченным доступом. В группу "Трейдеры" перемещает только администратор по запросу. Заодно будет что делать в админской записи :).

После успешной регистрации и подтверждения e-mail/телефон -- заполнение профиля пользователя в личном кабинете. ФИО, номер ID, дата рождения, адрес, реквизиты счёта. Без условно правильного заполнения этих полей кнопка "Запросить полный доступ" не активна. После заполнения можно нажать на неё и наблюдать статус "Ожидание обработки запроса" до тех пор, пока администратор не подтвердит запрос. После подтверждения пользователь приваивается группа "Трейдеры" и он получает доступ ко всем функциям терминала.

## Логин
Форма логина позволяет войти в учётную запись по комбинации логин/пароль, установленной при регистрации. Логином может служить адрес e-mai или телефон. Без логина использование программы не должно быть возможно. При ошибке ввода данных есть смысл сделать небольшую задержку. На бэкенде также будет нарастающая задержка при неправильном вводе пароля. 

В идеале стоит предусмотреть как минимум "заглушку" для функции "Получить одноразовый пароль" и ввод кода двухфакторной аутентификации. Понятно, что реально делать дфухфакторку мы врядли будем, но хотя бы оставить для неё место стоит (скажем, принимать пока любой код правильной длины). 

## Информация в торговом терминале
В режиме "Гость" можно просматривать:
1. Историю биржевых котировок по любому из товаров из списка. Графики вида "японские свечи", комбинированные с объёмом сделок. Интервал суммирования 1 день для долгого периода (месяц-три-полгода-год) и 5 минут за текущий день. Бэкенд будет отдавать данные по запросу как за заданный исторический период, так и новые данные с момента последнего запроса, дело фронта -- взять JSON и оформить в график.
   ![[Stock-market.png]]
2. По возможности нужна возможность поставить галочки на нескольких товарах и получить простой линейный график средней цены сделки за те же периоды по нескольким товарам.
   ![[f116fc.jpg]]
3. Собственно список товаров с текущими ценами и индикаторами роста/снижения.
   ![[rates.gif]]
5. По возможности, можно сделать окно "Таблица всех сделок", где отображаются все реально совершённые сделки по данному товару за некоторый период.
   ![[34ee8e.png]]

В режиме "Трейдер" к этому добавляется:
1. "Стакан" - список заявок на покупку и продажу отсортированный по цене заявки с объёмами заявок.
   ![[gl-qu01.png]]
2. Информация о состоянии счёта трейдера. На нём отображается количество денег на брокерском счёте и все закупленные активы (товары) в натуральном и денежном выражении. Для каждой позиции активов указывается средняя цена их покупки и текущая цена этого актива на торгах, отображается общая стоимость по цене покупки и при продаже по цене на торгах, расчитывается прибыль/убыток в случае их немедленной продажи.
3. Информация о выставленных заявках. Цена, товар, объём, время размещения, текущая рыночная цена актива.
4. Информация об исполненных заявках. Цена, товар, объём, время размещения, время исполнения, сумма, прибыльность.
5. Команды "Пополнение брокерского счёта" и "Вывод средств с брокерского счета", как вариант с симуляцией перечисления средств на внешний счёт.

## Размещение заявок
С любого из графиков, на котором отображается только один товар, или со строки актива в окне счета должна быть возможность быстро перейти к размещению заявки на покупку или продажу этого товара. Как вариант, можно постоянно отображать её в специально выделенном участке экрана, как на Рисунке 3 раздела "Примеры дизайна терминалов" (далее).

В форме заявки вводится количество товара в лотах (для каждого товара установлен фиксирвоанный размер лота, например 1 тонна угля, 1000 баррелей нефти, 100 унций золота и т.д.; продажа дробными лотами невозможна) и цена. 
![[12-549x1024.jpg]]
В заявке на продажу для объёма можно сделать кнопку "Продать всё", для цены - кнопку "По рыночной цене" после нажатия на которую поле ввода цены становится неактивным. 

В заявке на покупку для объёма стоит сделать кнопку "Купить на все средства", а для цены обязательна кнопка "По рыночной цене". При выборе "Купить на все средства" нужно расчитать сколько лотов товара трейдер может купить исходя из суммы его средств и рыночной цены и заполнить поле соответственно. При выборе "По рыночной цене" поле ввода цены становится неактивным.

![[29-07-2019-investments-short-selling.png]]

Желательно чтобы вводить числа можно было без использования клавиатуры с помощью графических элементов управления.

Проверки: 
1. Нельзя вводить большее количество товара, чем есть у трейдера, в заявке на продажу.
2. Нельзя пытаться разместить заявку на покупку на большую сумму, чем есть на брокерском счёте (при размещении заявки "По рыночной цене" необходимо сделать прогноз итоговой цены исходя из текущей информации  о заявках, с алгоритмом я помогу если будут вопросы).

После размещения заявки она дополнительно проверяется на бэкенде. Если всё нормально, заявке присваивается номер, который сообщается клиенту. Если происходит ошибка или заявка не проходит проверку, возвращается сообщение об ошибке и соответствующий статус.

Формы заявок на покупку и продажу желательно маркировать цветом аналогично тому, как они маркируются в стакане.

## Исполнение заявок
Если заявка исполнена, трейдер должен получить уведомление. Форму уведомления оставим на усмотрение дизайнера, но она не должна быть модальным окном. Информационные сообщения никогда не должны блокировать интерфейс.

При исполнении заявки необходимо немедленно обновить данные о денежных средствах и активах.

## Примеры дизайна терминалов
Рисунок 1
![[y8-ooaqwoy0h1fitigqc6ga-cbw.png]]
Рисунок 2
![[1137c844986e500008a30a8f248dbc3d.gif]]
Рисунок 3
![[_23-09-2021_182553.png]]

# Функционал рабочего места администратора системы
1. Подтверждение и отмена статуса "Трейдер" для зарегистрированных пользователей. Дополнительный контроль: если профиль пользователя не заполнен, перевести его в трейдеры нельзя.
2. Блокировка и разблокировка пользователей. (Если захочется странного - сделать механизм исключения с биржи с продажей всех автивов "По рынку" и симуляцией перечисления денежных средств на счёт клиента) Заблокированные пользователи не должны иметь возможность войти в свою учётную запись, при попытке логина получают сообщение о блокировке.
3. Редактирование списка товаров. Контроль: нельзя удалить или изменить товар, который есть в заявках или в активах на балансе хотя бы одного пользователя. В идеале, при первом логине после изменений списков товаров, пользователи должны получать извещение об этих изменениях. Для этого можно предусмотреть, что при успешном логине бэкенд передаёт фронтенду блок информации для пользователя ("Новости за время отсутствия"), который показывается в специально отведенной части экрана.
4. Снятие товара с торгов. Запрещает проведение сделок и отменяет все выставленные заявки.
5. Просмотр истории торгов и заявок за заданный промежуток времени.
6. Просмотр списка пользователей с указанием сумм денежных средств, активов и объёма сделок за заданный промежуток времени с возможностью сортировки по столбцам.
7. Для красоты - дашборд, позволяющий увидеть наиболее активных пользователей (по максимальному числу и объёму сделок), наиболее востребованные товары (аналогично) и динамику показателей оборота биржи за некий период. Тренируем визуализацию данных :).